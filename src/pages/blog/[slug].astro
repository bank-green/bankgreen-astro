---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getByUIDSafe, getAllByTypeSafe } from "@lib/prismic";
import { BlogPostPage } from "@components/pages";

export async function getStaticPaths() {
  const posts = await getAllByTypeSafe("blogpost");
  return posts.map((post) => ({ params: { slug: post.uid } }));
}

const { slug } = Astro.params;
const post = await getByUIDSafe("blogpost", slug as string);

if (!post) {
  return Astro.redirect("/404");
}

const title = post.data.title || "Blog Post";
---

<BaseLayout title={title}>
  <BlogPostPage post={post} />
</BaseLayout>
