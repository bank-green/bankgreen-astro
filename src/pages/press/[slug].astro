---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getByUIDSafe, getAllByTypeSafe } from "@lib/prismic";
import { PressReleasePage } from "@components/pages";

export async function getStaticPaths() {
  const releases = await getAllByTypeSafe("pressrelease");
  return releases.map((release) => ({ params: { slug: release.uid } }));
}

const { slug } = Astro.params;
const release = await getByUIDSafe("pressrelease", slug as string);

if (!release) {
  return Astro.redirect("/404");
}

const title = release.data.title || "Press Release";
---

<BaseLayout title={title}>
  <PressReleasePage release={release} client:load />
</BaseLayout>
