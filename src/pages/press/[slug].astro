---
import { PressReleasePage } from '@components/pages'
import BaseLayout from '@layouts/BaseLayout.astro'
import { getAllByTypeSafe, getByUIDSafe } from '@lib/prismic'

export const prerender = true

export async function getStaticPaths() {
  const releases = await getAllByTypeSafe('presspost')
  return releases.map((release) => ({ params: { slug: release.uid } }))
}

const { slug } = Astro.params
const release = await getByUIDSafe('presspost', slug as string)

if (!release) {
  return Astro.redirect('/404')
}

const title = release.data.title || 'Press Release'
const description = (release.data.description as string) || undefined
---

<BaseLayout title={title} description={description}>
  <PressReleasePage release={release} />
</BaseLayout>
