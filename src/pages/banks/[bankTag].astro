---
import { BankScorePage } from '@components/pages'
import BaseLayout from '@layouts/BaseLayout.astro'
import type { Bank } from '@lib/banks'

interface BankData {
  name: string
  tag: string
  commentary?: {
    showOnSustainableBanksPage?: boolean
  }
}

export async function getStaticPaths() {
  const { fetchAllBrands } = await import('@lib/queries/brands')
  const brands = await fetchAllBrands()
  const data = brands?.filter(
    (bank: BankData) => bank.commentary?.showOnSustainableBanksPage !== false
  )
  const mapped = data?.map((bank: BankData) => ({
    params: { bankTag: bank.tag },
  }))
  return mapped || []
}

const { bankTag } = Astro.params

// TODO: Fetch bank data from GraphQL
const bank: BankData | null = null

const bankName = (bank as BankData | null)?.name ?? 'Bank'
const title = `${bankName}'s Climate Score`
---

<BaseLayout title={title}>
  <BankScorePage bank={bank} client:load />
</BaseLayout>
